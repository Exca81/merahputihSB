<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boss Time Tracker - MERAHPUTIH</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-red: #dc2626;
            --light-red: #fecaca;
            --dark-red: #991b1b;
            --pure-white: #ffffff;
            --off-white: #f8fafc;
            --gray: #6b7280;
            --dark-gray: #374151;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --success-green: #10b981;
            --warning-yellow: #f59e0b;
            --info-blue: #3b82f6;
            --danger-red: #ef4444;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--pure-white) 0%, var(--off-white) 100%);
            color: var(--dark-gray);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(to right, var(--primary-red), var(--dark-red));
            border-radius: 15px;
            border: 3px solid var(--primary-red);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .header h1 {
            color: var(--pure-white);
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .header h1 i {
            color: var(--light-red);
            margin-right: 15px;
        }
        
        .header p {
            color: var(--light-red);
            font-size: 1.2rem;
            font-weight: 500;
            position: relative;
        }
        
        .guild-tag {
            display: inline-block;
            background: var(--pure-white);
            color: var(--primary-red);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
            box-shadow: var(--shadow);
        }
        
        .admin-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .admin-btn {
            background: var(--pure-white);
            color: var(--primary-red);
            border: 2px solid var(--pure-white);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }
        
        .admin-btn:hover {
            background: var(--primary-red);
            color: var(--pure-white);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.3);
        }
        
        .logout-btn {
            background: transparent;
            color: var(--pure-white);
            border-color: var(--pure-white);
        }
        
        .logout-btn:hover {
            background: var(--pure-white);
            color: var(--primary-red);
        }
        
        .alarm-controls {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .alarm-btn {
            background: rgba(255, 255, 255, 0.2);
            color: var(--pure-white);
            border: 2px solid var(--pure-white);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .alarm-btn:hover {
            background: var(--pure-white);
            color: var(--primary-red);
            transform: translateY(-2px);
        }
        
        .alarm-btn.active {
            background: var(--pure-white);
            color: var(--primary-red);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .alarm-btn.muted {
            opacity: 0.7;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--pure-white);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--light-red);
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-red);
        }
        
        .card-title {
            color: var(--primary-red);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-red);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .card-title i {
            font-size: 1.3rem;
            color: var(--dark-red);
        }
        
        .edit-btn {
            background: var(--primary-red);
            color: var(--pure-white);
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .edit-btn:hover {
            background: var(--dark-red);
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(220, 38, 38, 0.3);
        }
        
        .admin-notes textarea {
            width: 100%;
            height: 120px;
            background: var(--off-white);
            border: 2px solid var(--light-red);
            border-radius: 10px;
            color: var(--dark-gray);
            padding: 15px;
            font-size: 1rem;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        .admin-notes textarea:focus {
            outline: none;
            border-color: var(--primary-red);
        }
        
        .boss-info {
            text-align: center;
            background: linear-gradient(to bottom, var(--off-white), var(--pure-white));
        }
        
        .boss-name {
            font-size: 2.2rem;
            color: var(--dark-red);
            margin-bottom: 15px;
            text-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
        }
        
        .boss-timer {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary-red);
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 10px rgba(220, 38, 38, 0.2);
            transition: all 0.3s;
        }
        
        .boss-timer.alarm {
            color: #ff0000;
            animation: pulse-alarm 1s infinite;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }
        
        @keyframes pulse-alarm {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .time-info {
            color: var(--gray);
            font-size: 1.1rem;
            margin-top: 10px;
            font-weight: 500;
        }
        
        .current-time {
            text-align: center;
        }
        
        .time-display {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .timezone {
            background: var(--off-white);
            padding: 15px;
            border-radius: 10px;
            min-width: 180px;
            border: 2px solid var(--light-red);
        }
        
        .timezone .time {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-red);
            margin-bottom: 5px;
            font-family: 'Courier New', monospace;
        }
        
        .timezone .label {
            color: var(--primary-red);
            font-size: 1rem;
            font-weight: 600;
        }
        
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.95rem;
        }
        
        .schedule-table th {
            background-color: var(--primary-red);
            color: var(--pure-white);
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .schedule-table td {
            padding: 12px;
            border-bottom: 2px solid var(--light-red);
            vertical-align: top;
        }
        
        .schedule-table tr:hover {
            background-color: var(--off-white);
        }
        
        .schedule-table tr.active-boss {
            background-color: rgba(220, 38, 38, 0.1);
            border-left: 4px solid var(--primary-red);
        }
        
        .schedule-table tr.inactive-day {
            opacity: 0.6;
            background-color: rgba(203, 213, 225, 0.3);
        }
        
        .boss-level {
            display: inline-block;
            background: var(--primary-red);
            color: var(--pure-white);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
        }
        
        .fixed-schedule {
            color: var(--dark-red);
            font-weight: bold;
            background: var(--light-red);
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.85rem;
        }
        
        .interval-schedule {
            color: var(--info-blue);
            font-weight: bold;
            background: #dbeafe;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.85rem;
        }
        
        .active-indicator {
            display: inline-block;
            background: var(--success-green);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
            animation: pulse 2s infinite;
        }
        
        .day-badge {
            display: inline-block;
            background: #8b5cf6;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .day-off-badge {
            display: inline-block;
            background: var(--gray);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .alarm-indicator {
            display: inline-block;
            background: var(--warning-yellow);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
            animation: pulse 1s infinite;
        }
        
        .spawn-order {
            display: inline-block;
            background: var(--info-blue);
            color: white;
            padding: 3px 8px;
            border-radius: 50%;
            font-size: 0.8rem;
            font-weight: bold;
            min-width: 25px;
            text-align: center;
            margin-right: 8px;
        }
        
        .last-spawn-time {
            color: var(--gray);
            font-size: 0.85rem;
            margin-top: 3px;
        }
        
        .next-spawn-time {
            font-weight: 600;
            color: var(--dark-red);
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .action-btn {
            background: var(--primary-red);
            border: none;
            color: var(--pure-white);
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: var(--dark-red);
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(220, 38, 38, 0.3);
        }
        
        .add-boss-container {
            margin-top: 30px;
            padding: 20px;
            background: var(--pure-white);
            border-radius: 15px;
            border: 2px dashed var(--primary-red);
            text-align: center;
        }
        
        .add-boss-btn {
            background: linear-gradient(to right, var(--primary-red), var(--dark-red));
            color: var(--pure-white);
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }
        
        .add-boss-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(220, 38, 38, 0.3);
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }
        
        .btn-refresh {
            background: var(--pure-white);
            color: var(--primary-red);
            border: 2px solid var(--primary-red);
        }
        
        .btn-countdown {
            background: var(--primary-red);
            color: var(--pure-white);
            border: 2px solid var(--primary-red);
        }
        
        .btn-alarm {
            background: var(--warning-yellow);
            color: var(--pure-white);
            border: 2px solid var(--warning-yellow);
        }
        
        .btn-timestamp {
            background: var(--dark-gray);
            color: var(--pure-white);
            border: 2px solid var(--dark-gray);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: var(--pure-white);
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            padding: 30px;
            border: 3px solid var(--primary-red);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-red);
        }
        
        .modal-title {
            color: var(--primary-red);
            font-size: 1.5rem;
        }
        
        .close-modal {
            background: transparent;
            border: none;
            color: var(--gray);
            font-size: 1.8rem;
            cursor: pointer;
            transition: color 0.3s;
            line-height: 1;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            color: var(--primary-red);
            background: var(--off-white);
            border-radius: 50%;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark-gray);
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: var(--off-white);
            border: 2px solid var(--light-red);
            border-radius: 8px;
            color: var(--dark-gray);
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }
        
        .time-inputs {
            display: flex;
            gap: 10px;
        }
        
        .time-inputs input {
            flex: 1;
        }
        
        .days-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .day-checkbox {
            display: none;
        }
        
        .day-label {
            display: block;
            padding: 10px;
            text-align: center;
            background: var(--off-white);
            border: 2px solid var(--light-red);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .day-checkbox:checked + .day-label {
            background: var(--primary-red);
            color: var(--pure-white);
            border-color: var(--primary-red);
        }
        
        .day-label:hover {
            background: var(--light-red);
        }
        
        .days-note {
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--gray);
            text-align: center;
            line-height: 1.4;
        }
        
        .interval-note {
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--gray);
            text-align: left;
            font-style: italic;
            line-height: 1.4;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 30px;
        }
        
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 100px;
        }
        
        .modal-btn.save {
            background: var(--primary-red);
            color: var(--pure-white);
        }
        
        .modal-btn.cancel {
            background: var(--off-white);
            color: var(--dark-gray);
            border: 2px solid var(--light-red);
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        /* Login Modal */
        .login-form {
            max-width: 400px;
        }
        
        .admin-status {
            display: inline-block;
            background: var(--primary-red);
            color: var(--pure-white);
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            margin-left: 10px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 2px solid var(--light-red);
        }
        
        .guild-motto {
            color: var(--primary-red);
            font-weight: bold;
            font-size: 1rem;
            margin-top: 5px;
        }
        
        /* Hide admin controls for non-admin */
        .admin-only {
            display: none;
        }
        
        .admin-logged-in .admin-only {
            display: inline-flex;
        }
        
        .admin-logged-in .admin-only-block {
            display: block;
        }
        
        /* Alarm notification */
        .alarm-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary-red);
            color: var(--pure-white);
            padding: 30px 40px;
            border-radius: 15px;
            z-index: 2000;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            border: 4px solid var(--light-red);
            animation: alarm-popup 0.5s ease-out;
            display: none;
            max-width: 90%;
            width: 400px;
        }
        
        @keyframes alarm-popup {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            70% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .alarm-notification h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--light-red);
        }
        
        .alarm-notification p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .alarm-notification .close-alarm {
            background: var(--pure-white);
            color: var(--primary-red);
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .alarm-notification .close-alarm:hover {
            background: var(--light-red);
            transform: translateY(-2px);
        }
        
        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--light-red);
            border-radius: 50%;
            border-top-color: var(--primary-red);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Confirmation modal */
        .confirm-modal {
            max-width: 400px;
        }
        
        .confirm-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .confirm-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 80px;
        }
        
        .confirm-btn.yes {
            background: var(--danger-red);
            color: white;
        }
        
        .confirm-btn.no {
            background: var(--gray);
            color: white;
        }
        
        /* Error states */
        .error-input {
            border-color: var(--danger-red) !important;
        }
        
        .error-message {
            color: var(--danger-red);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .admin-controls {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }
            
            .time-display {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .days-container {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .alarm-notification {
                width: 90%;
                padding: 20px;
            }
            
            .schedule-table {
                font-size: 0.85rem;
            }
            
            .schedule-table th,
            .schedule-table td {
                padding: 8px;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .boss-timer {
                font-size: 2.2rem;
            }
            
            .boss-name {
                font-size: 1.8rem;
            }
            
            .card-title {
                font-size: 1.3rem;
            }
            
            .days-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-dragon"></i> Boss Time Tracker</h1>
            <p>Real-time tracking for Boss spawn schedules</p>
            <div class="guild-tag">MERAHPUTIH</div>
            
            <div class="admin-controls">
                <button class="admin-btn" id="adminLoginBtn">
                    <i class="fas fa-user-shield"></i> Admin Login
                </button>
                <button class="admin-btn logout-btn admin-only" id="adminLogoutBtn" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
            
            <div class="alarm-controls">
                <button class="alarm-btn" id="toggleAlarmBtn">
                    <i class="fas fa-bell"></i> Alarm: ON
                </button>
                <button class="alarm-btn" id="testAlarmBtn">
                    <i class="fas fa-volume-up"></i> Test Alarm
                </button>
                <button class="alarm-btn" id="muteAlarmBtn">
                    <i class="fas fa-volume-mute"></i> Mute
                </button>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="card admin-notes">
                <h2 class="card-title">
                    <span><i class="fas fa-sticky-note"></i> GUILD NOTES</span>
                    <button class="edit-btn admin-only" id="editNotesBtn" style="display: none;">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </h2>
                <textarea id="adminNotes" placeholder="Enter guild notes here..." readonly>ini untuk isi catatan utang, pesan moral, dan pesan pesan lainnya</textarea>
            </div>
            
            <div class="card boss-info">
                <h2 class="card-title">
                    <span><i class="fas fa-crown"></i> NEXT BOSS SPAWN</span>
                    <button class="edit-btn admin-only" id="editBossTimeBtn" style="display: none;">
                        <i class="fas fa-clock"></i> Set Time
                    </button>
                </h2>
                <div class="boss-name" id="currentBoss">Loading...</div>
                <div class="boss-timer" id="countdownTimer">--:--:--</div>
                <div class="time-info">
                    <div id="bossSpawnTime">Auto-calculating next spawn...</div>
                    <div id="alarmStatus" style="margin-top: 10px; font-size: 0.9rem; color: #f59e0b;">
                        <i class="fas fa-bell"></i> Alarm aktif 5 menit sebelum spawn
                    </div>
                </div>
            </div>
            
            <div class="card current-time">
                <h2 class="card-title">
                    <span><i class="fas fa-clock"></i> CURRENT TIME</span>
                    <button class="edit-btn admin-only" id="editServerTimeBtn" style="display: none;">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                </h2>
                <div class="time-display">
                    <div class="timezone">
                        <div class="time" id="indoTime">--:--:--</div>
                        <div class="label">INDO TIME UTC+7</div>
                    </div>
                    <div class="timezone">
                        <div class="time" id="phTime">--:--:--</div>
                        <div class="label">PH TIME UTC+8</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title">
                <span><i class="fas fa-calendar-alt"></i> FIELD BOSS SCHEDULE</span>
                <button class="edit-btn admin-only" id="editScheduleBtn" style="display: none;">
                    <i class="fas fa-plus-circle"></i> Add Boss
                </button>
            </h2>
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>LV</th>
                        <th>BOSS NAME</th>
                        <th>SCHEDULE TYPE</th>
                        <th>LAST SPAWN</th>
                        <th>NEXT SPAWN</th>
                        <th class="admin-only-block" style="display: none;">ACTIONS</th>
                    </tr>
                </thead>
                <tbody id="bossSchedule">
                    <!-- Boss schedule will be populated by JavaScript -->
                </tbody>
            </table>
            
            <div class="add-boss-container admin-only-block" style="display: none;">
                <button class="add-boss-btn" id="addNewBossBtn">
                    <i class="fas fa-plus"></i> ADD NEW FIELD BOSS
                </button>
                <p style="margin-top: 15px; color: var(--gray); font-size: 0.9rem;">
                    Click to add custom Field Boss with flexible schedule options
                </p>
            </div>
        </div>
        
        <div class="buttons">
            <button class="btn btn-refresh" id="refreshBtn">
                <i class="fas fa-sync-alt"></i> Refresh All
            </button>
            <button class="btn btn-countdown" id="countdownBtn">
                <i class="fas fa-hourglass-half"></i> COUNTDOWN
            </button>
            <button class="btn btn-alarm" id="alarmBtn">
                <i class="fas fa-bell"></i> TEST ALARM
            </button>
            <button class="btn btn-timestamp" id="timestampBtn">
                <i class="fas fa-calendar-day"></i> TIME STAMP
            </button>
        </div>
        
        <div class="footer">
            <p>ACUMALAKA TEAMS 2026</p>
            <p class="guild-motto">Log in dulu, mikir belakangan</p>
        </div>
    </div>

    <!-- Alarm Notification Modal -->
    <div class="alarm-notification" id="alarmNotification">
        <h3><i class="fas fa-bell"></i> BOSS ALARM!</h3>
        <p id="alarmMessage">Boss will spawn in 5 minutes!</p>
        <button class="close-alarm" id="closeAlarmBtn">OK, I'm Ready!</button>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content login-form">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-user-shield"></i> Admin Login</h3>
                <button class="close-modal" id="closeLoginModal">&times;</button>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="adminUsername">Username</label>
                    <input type="text" id="adminUsername" placeholder="Enter admin username" required>
                    <div class="error-message" id="usernameError"></div>
                </div>
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                    <div class="error-message" id="passwordError"></div>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="modal-btn cancel" id="cancelLogin">Cancel</button>
                    <button type="submit" class="modal-btn save">Login</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Boss Modal -->
    <div class="modal" id="addBossModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="bossModalTitle"><i class="fas fa-dragon"></i> Add New Field Boss</h3>
                <button class="close-modal" id="closeAddBossModal">&times;</button>
            </div>
            
            <form id="addBossForm">
                <input type="hidden" id="editBossId" value="">
                
                <div class="form-group">
                    <label for="bossLevel">Boss Level</label>
                    <input type="number" id="bossLevel" min="1" max="200" placeholder="e.g., 88" required>
                    <div class="error-message" id="levelError"></div>
                </div>
                
                <div class="form-group">
                    <label for="bossName">Boss Name *</label>
                    <input type="text" id="bossName" placeholder="e.g., Crimson Dragon" required>
                    <div class="error-message" id="nameError"></div>
                </div>
                
                <div class="form-group">
                    <label for="bossType">Boss Type</label>
                    <select id="bossType">
                        <option value="regular">Regular Field Boss</option>
                        <option value="world">World Boss</option>
                        <option value="raid">Raid Boss</option>
                        <option value="dungeon">Dungeon Boss</option>
                        <option value="event">Event Boss</option>
                        <option value="weekly">Weekly Boss</option>
                    </select>
                </div>
                
                <!-- LAST SPAWN TIME -->
                <div class="form-group">
                    <label for="spawnHour">LAST Spawn Time (24-hour format) *</label>
                    <div class="time-inputs">
                        <input type="number" id="spawnHour" min="0" max="23" placeholder="Hour (0-23)" required>
                        <input type="number" id="spawnMinute" min="0" max="59" placeholder="Minute (0-59)" required>
                    </div>
                    <div class="error-message" id="timeError"></div>
                    <small style="color: var(--gray); display: block; margin-top: 5px;">Waktu spawn TERAKHIR boss.</small>
                </div>
                
                <!-- DAYS SELECTION -->
                <div class="form-group">
                    <label>Select Days (Optional - Leave empty for every day)</label>
                    <div class="days-container">
                        <input type="checkbox" id="day-sun" class="day-checkbox" value="0">
                        <label for="day-sun" class="day-label">Sun</label>
                        
                        <input type="checkbox" id="day-mon" class="day-checkbox" value="1">
                        <label for="day-mon" class="day-label">Mon</label>
                        
                        <input type="checkbox" id="day-tue" class="day-checkbox" value="2">
                        <label for="day-tue" class="day-label">Tue</label>
                        
                        <input type="checkbox" id="day-wed" class="day-checkbox" value="3">
                        <label for="day-wed" class="day-label">Wed</label>
                        
                        <input type="checkbox" id="day-thu" class="day-checkbox" value="4">
                        <label for="day-thu" class="day-label">Thu</label>
                        
                        <input type="checkbox" id="day-fri" class="day-checkbox" value="5">
                        <label for="day-fri" class="day-label">Fri</label>
                        
                        <input type="checkbox" id="day-sat" class="day-checkbox" value="6">
                        <label for="day-sat" class="day-label">Sat</label>
                    </div>
                    <p class="days-note">
                        Leave all days unselected for boss to spawn EVERY DAY<br>
                        <strong>Note:</strong> Jika memilih hari tertentu, interval otomatis menjadi 0 (spawn mingguan)
                    </p>
                </div>
                
                <!-- RESPAWN INTERVAL (HIDDEN/SHOW BASED ON DAYS) -->
                <div class="form-group" id="intervalGroup">
                    <label for="respawnInterval">Respawn Interval (Hours) *</label>
                    <input type="number" id="respawnInterval" min="0" max="168" placeholder="e.g., 2 (for 2 hours), 0 for weekly" value="2" required>
                    <div class="error-message" id="intervalError"></div>
                    <p class="interval-note" id="intervalNote">
                        Untuk boss yang spawn setiap hari. Contoh: input 16:00 dengan interval 10h = next spawn 02:00
                    </p>
                </div>
                
                <div class="form-group">
                    <label for="bossNotes">Additional Notes (Optional)</label>
                    <textarea id="bossNotes" placeholder="e.g., Drops legendary equipment, requires 10+ players" rows="3"></textarea>
                </div>
                
                <div class="modal-buttons">
                    <button type="button" class="modal-btn cancel" id="cancelAddBoss">Cancel</button>
                    <button type="submit" class="modal-btn save" id="saveBossBtn">Add Boss</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content confirm-modal">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Confirmation</h3>
                <button class="close-modal" id="closeConfirmModal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Are you sure?</p>
                <div class="confirm-buttons">
                    <button class="confirm-btn yes" id="confirmYes">Yes</button>
                    <button class="confirm-btn no" id="confirmNo">No</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Admin credentials
        const ADMIN_CREDENTIALS = {
            username: "admin",
            password: "acumalaka2026"
        };
        
        // Days of week for display
        const DAYS_OF_WEEK = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const DAYS_SHORT = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        
        // Boss data structure
        let bossSchedule = [
            { 
                id: 1, 
                level: 88, 
                name: "Amentis", 
                type: "regular", 
                scheduleType: "interval", 
                nextSpawnTime: null,
                lastSpawnTime: null,
                respawnInterval: 2,
                spawnDays: null,
                notes: "",
                isActive: false,
                spawnOrder: 0
            },
            { 
                id: 2, 
                level: 75, 
                name: "Araneo", 
                type: "regular", 
                scheduleType: "interval",
                nextSpawnTime: null,
                lastSpawnTime: null,
                respawnInterval: 3,
                spawnDays: [1, 3, 5],
                notes: "Poison attacks",
                isActive: false,
                spawnOrder: 0
            },
            { 
                id: 3, 
                level: 100, 
                name: "Asta", 
                type: "world", 
                scheduleType: "weekly",
                nextSpawnTime: null,
                lastSpawnTime: null,
                respawnInterval: 0,
                spawnDays: [6],
                notes: "Weekend world boss - Sabtu jam 16:00",
                isActive: false,
                spawnOrder: 0
            },
            { 
                id: 4, 
                level: 150, 
                name: "Ancient Dragon", 
                type: "raid", 
                scheduleType: "interval",
                nextSpawnTime: null,
                lastSpawnTime: null,
                respawnInterval: 32,
                spawnDays: null,
                notes: "32h respawn time, drops legendary items",
                isActive: false,
                spawnOrder: 0
            }
        ];
        
        // Application state
        let isAdminLoggedIn = false;
        let currentBossIndex = 0;
        let countdownSeconds = 0;
        let activeBossId = null;
        let currentBossToDelete = null;
        
        // Alarm settings
        let alarmEnabled = true;
        let alarmMuted = false;
        let alarmTriggered = false;
        let alarmCooldown = false;
        const ALARM_THRESHOLD = 300;
        
        // Audio context for sound
        let audioContext;
        let alarmSound;
        
        // DOM Elements
        const adminLoginBtn = document.getElementById('adminLoginBtn');
        const adminLogoutBtn = document.getElementById('adminLogoutBtn');
        const adminNotes = document.getElementById('adminNotes');
        const currentBoss = document.getElementById('currentBoss');
        const countdownTimer = document.getElementById('countdownTimer');
        const bossSpawnTime = document.getElementById('bossSpawnTime');
        const indoTime = document.getElementById('indoTime');
        const phTime = document.getElementById('phTime');
        const bossScheduleTable = document.getElementById('bossSchedule');
        const refreshBtn = document.getElementById('refreshBtn');
        const countdownBtn = document.getElementById('countdownBtn');
        const alarmBtn = document.getElementById('alarmBtn');
        const timestampBtn = document.getElementById('timestampBtn');
        const editNotesBtn = document.getElementById('editNotesBtn');
        const editBossTimeBtn = document.getElementById('editBossTimeBtn');
        const editServerTimeBtn = document.getElementById('editServerTimeBtn');
        const editScheduleBtn = document.getElementById('editScheduleBtn');
        const addNewBossBtn = document.getElementById('addNewBossBtn');
        const toggleAlarmBtn = document.getElementById('toggleAlarmBtn');
        const testAlarmBtn = document.getElementById('testAlarmBtn');
        const muteAlarmBtn = document.getElementById('muteAlarmBtn');
        const alarmNotification = document.getElementById('alarmNotification');
        const alarmMessage = document.getElementById('alarmMessage');
        const closeAlarmBtn = document.getElementById('closeAlarmBtn');
        
        // Modal elements
        const loginModal = document.getElementById('loginModal');
        const addBossModal = document.getElementById('addBossModal');
        const confirmModal = document.getElementById('confirmModal');
        const intervalGroup = document.getElementById('intervalGroup');
        const intervalNote = document.getElementById('intervalNote');
        const respawnIntervalInput = document.getElementById('respawnInterval');
        const editBossIdInput = document.getElementById('editBossId');
        const saveBossBtn = document.getElementById('saveBossBtn');
        const bossModalTitle = document.getElementById('bossModalTitle');
        
        // Error message elements
        const levelError = document.getElementById('levelError');
        const nameError = document.getElementById('nameError');
        const timeError = document.getElementById('timeError');
        const intervalError = document.getElementById('intervalError');
        
        // Initialize function
        function init() {
            loadFromLocalStorage();
            initializeAudio();
            calculateAllNextSpawnTimes();
            sortBossesBySpawnTime();
            updateActiveBoss();
            populateBossSchedule();
            updateTimes();
            setInterval(updateTimes, 1000);
            setInterval(checkBossSpawn, 1000);
            setInterval(checkAlarm, 1000);
            
            updateAlarmButtons();
            
            // Add event listener for day selection changes
            document.querySelectorAll('.day-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateIntervalFieldVisibility);
            });
            
            // Initialize event listeners
            initEventListeners();
            
            // Check for admin session
            checkAdminSession();
        }
        
        // Check admin session from localStorage
        function checkAdminSession() {
            const savedAdmin = localStorage.getItem('acumalakaAdminLoggedIn');
            if (savedAdmin === 'true') {
                loginAdmin(ADMIN_CREDENTIALS.username, ADMIN_CREDENTIALS.password, true);
            }
        }
        
        // Initialize all event listeners
        function initEventListeners() {
            // Admin login/logout
            adminLoginBtn.addEventListener('click', () => openModal(loginModal));
            adminLogoutBtn.addEventListener('click', logoutAdmin);
            
            // Alarm controls
            toggleAlarmBtn.addEventListener('click', function() {
                alarmEnabled = !alarmEnabled;
                updateAlarmButtons();
                saveToLocalStorage();
                showNotification(`Alarm ${alarmEnabled ? 'enabled' : 'disabled'}`, 'info');
            });
            
            testAlarmBtn.addEventListener('click', testAlarm);
            
            muteAlarmBtn.addEventListener('click', function() {
                alarmMuted = !alarmMuted;
                if (alarmMuted) {
                    stopAlarmSound();
                }
                updateAlarmButtons();
                saveToLocalStorage();
                showNotification(`Alarm ${alarmMuted ? 'muted' : 'unmuted'}`, 'info');
            });
            
            closeAlarmBtn.addEventListener('click', closeAlarm);
            
            alarmBtn.addEventListener('click', testAlarm);
            
            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('adminUsername').value;
                const password = document.getElementById('adminPassword').value;
                loginAdmin(username, password, false);
            });
            
            // Add new boss button
            addNewBossBtn.addEventListener('click', addNewBoss);
            editScheduleBtn.addEventListener('click', addNewBoss);
            
            // Add/Edit boss form
            document.getElementById('addBossForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleBossFormSubmit();
            });
            
            // Close modals
            document.getElementById('closeLoginModal').addEventListener('click', () => closeModal(loginModal));
            document.getElementById('closeAddBossModal').addEventListener('click', () => closeModal(addBossModal));
            document.getElementById('closeConfirmModal').addEventListener('click', () => closeModal(confirmModal));
            document.getElementById('cancelLogin').addEventListener('click', () => closeModal(loginModal));
            document.getElementById('cancelAddBoss').addEventListener('click', () => closeModal(addBossModal));
            document.getElementById('confirmNo').addEventListener('click', () => closeModal(confirmModal));
            
            // Edit notes button
            editNotesBtn.addEventListener('click', function() {
                adminNotes.readOnly = false;
                adminNotes.focus();
                showNotification('Notes editor activated', 'info');
            });
            
            // Save notes on change
            adminNotes.addEventListener('change', function() {
                saveToLocalStorage();
                showNotification('Notes saved', 'success');
            });
            
            // Original button event handlers
            refreshBtn.addEventListener('click', function() {
                calculateAllNextSpawnTimes();
                sortBossesBySpawnTime();
                updateActiveBoss();
                populateBossSchedule();
                showNotification('All boss data refreshed!', 'success');
            });
            
            countdownBtn.addEventListener('click', function() {
                const bossName = currentBoss.textContent;
                const timeLeft = countdownTimer.textContent;
                showNotification(`Next boss "${bossName}" spawns in ${timeLeft}`, 'info');
            });
            
            timestampBtn.addEventListener('click', function() {
                const now = new Date();
                const timestamp = now.toISOString();
                showNotification(`Current timestamp: ${timestamp}`, 'info');
                navigator.clipboard.writeText(timestamp).then(() => {
                    showNotification('Timestamp copied to clipboard!', 'success');
                });
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === loginModal) closeModal(loginModal);
                if (e.target === addBossModal) closeModal(addBossModal);
                if (e.target === confirmModal) closeModal(confirmModal);
                if (e.target === alarmNotification) closeAlarm();
            });
            
            // Request notification permission
            if ('Notification' in window && Notification.permission === 'default') {
                setTimeout(() => {
                    Notification.requestPermission();
                }, 2000);
            }
            
            // Confirmation modal yes button
            document.getElementById('confirmYes').addEventListener('click', function() {
                if (currentBossToDelete) {
                    deleteBossConfirmed(currentBossToDelete);
                    closeModal(confirmModal);
                }
            });
        }
        
        // Handle boss form submission
        function handleBossFormSubmit() {
            // Reset error messages
            clearErrorMessages();
            
            // Get form values
            const level = parseInt(document.getElementById('bossLevel').value);
            const name = document.getElementById('bossName').value.trim();
            const type = document.getElementById('bossType').value;
            const hour = parseInt(document.getElementById('spawnHour').value) || 0;
            const minute = parseInt(document.getElementById('spawnMinute').value) || 0;
            const respawnInterval = parseInt(respawnIntervalInput.value) || 2;
            const notes = document.getElementById('bossNotes').value.trim();
            const bossId = editBossIdInput.value ? parseInt(editBossIdInput.value) : null;
            
            // Validation flags
            let isValid = true;
            
            // Validate level
            if (isNaN(level) || level < 1 || level > 200) {
                showError(levelError, 'Level must be between 1 and 200');
                document.getElementById('bossLevel').classList.add('error-input');
                isValid = false;
            }
            
            // Validate name
            if (!name) {
                showError(nameError, 'Boss name is required');
                document.getElementById('bossName').classList.add('error-input');
                isValid = false;
            }
            
            // Validate hour
            if (isNaN(hour) || hour < 0 || hour > 23) {
                showError(timeError, 'Hour must be between 0 and 23');
                document.getElementById('spawnHour').classList.add('error-input');
                isValid = false;
            }
            
            // Validate minute
            if (isNaN(minute) || minute < 0 || minute > 59) {
                showError(timeError, 'Minute must be between 0 and 59');
                document.getElementById('spawnMinute').classList.add('error-input');
                isValid = false;
            }
            
            // Get selected days
            const selectedDays = [];
            document.querySelectorAll('.day-checkbox:checked').forEach(cb => {
                selectedDays.push(parseInt(cb.value));
            });
            
            const spawnDays = selectedDays.length > 0 ? selectedDays : null;
            
            // Determine if this is weekly or interval schedule
            const isWeeklySchedule = spawnDays && spawnDays.length > 0 && respawnInterval === 0;
            const finalInterval = isWeeklySchedule ? 0 : respawnInterval;
            
            // Validate interval for interval schedule
            if (!isWeeklySchedule && (isNaN(finalInterval) || finalInterval < 1 || finalInterval > 168)) {
                showError(intervalError, 'Respawn interval must be between 1 and 168 hours');
                document.getElementById('respawnInterval').classList.add('error-input');
                isValid = false;
            }
            
            // Validate weekly schedule
            if (isWeeklySchedule && (!spawnDays || spawnDays.length === 0)) {
                showError(intervalError, 'For weekly schedule, you must select at least one day');
                isValid = false;
            }
            
            if (!isValid) {
                return;
            }
            
            // Create LAST spawn time based on user input
            const now = new Date();
            let lastSpawn = new Date(now);
            lastSpawn.setHours(hour, minute, 0, 0);
            
            // If the input time is in the future today, adjust to yesterday
            if (lastSpawn > now) {
                lastSpawn.setDate(lastSpawn.getDate() - 1);
            }
            
            // Adjust last spawn to match selected days for weekly schedule
            if (isWeeklySchedule) {
                // Find the closest past day that matches the schedule
                while (!spawnDays.includes(lastSpawn.getDay())) {
                    lastSpawn.setDate(lastSpawn.getDate() - 1);
                }
            }
            
            // Calculate next spawn time
            let nextSpawn;
            
            if (isWeeklySchedule) {
                // Weekly schedule
                nextSpawn = new Date(lastSpawn);
                
                // Find next occurrence in the future
                let daysAdded = 0;
                do {
                    nextSpawn.setDate(nextSpawn.getDate() + 1);
                    daysAdded++;
                    
                    // Safety check
                    if (daysAdded > 14) {
                        break;
                    }
                } while (!spawnDays.includes(nextSpawn.getDay()));
                
                // Make sure next spawn is in the future
                if (nextSpawn <= now) {
                    nextSpawn.setDate(nextSpawn.getDate() + 7);
                }
            } else {
                // Interval schedule
                nextSpawn = new Date(lastSpawn.getTime() + finalInterval * 3600000);
                
                // Make sure next spawn is in the future
                while (nextSpawn <= now) {
                    nextSpawn.setTime(nextSpawn.getTime() + finalInterval * 3600000);
                }
                
                // If specific days are selected, adjust to match
                if (spawnDays && spawnDays.length > 0) {
                    while (!spawnDays.includes(nextSpawn.getDay())) {
                        nextSpawn.setTime(nextSpawn.getTime() + 24 * 3600000);
                    }
                }
            }
            
            if (bossId) {
                // UPDATE EXISTING BOSS
                const bossIndex = bossSchedule.findIndex(b => b.id === bossId);
                
                if (bossIndex !== -1) {
                    bossSchedule[bossIndex] = {
                        ...bossSchedule[bossIndex],
                        level,
                        name,
                        type,
                        scheduleType: isWeeklySchedule ? "weekly" : "interval",
                        respawnInterval: finalInterval,
                        spawnDays,
                        notes,
                        lastSpawnTime: lastSpawn.toISOString(),
                        nextSpawnTime: nextSpawn.toISOString(),
                        isActive: false
                    };
                    
                    showNotification(`Boss ${name} updated successfully!`, 'success');
                }
            } else {
                // ADD NEW BOSS
                const newBoss = {
                    id: bossSchedule.length > 0 ? Math.max(...bossSchedule.map(b => b.id)) + 1 : 1,
                    level,
                    name,
                    type,
                    scheduleType: isWeeklySchedule ? "weekly" : "interval",
                    respawnInterval: finalInterval,
                    spawnDays,
                    notes,
                    lastSpawnTime: lastSpawn.toISOString(),
                    nextSpawnTime: nextSpawn.toISOString(),
                    isActive: false,
                    spawnOrder: 0
                };
                
                bossSchedule.push(newBoss);
                showNotification(`New boss ${name} added to schedule!`, 'success');
            }
            
            // Recalculate all spawn times and sort
            calculateAllNextSpawnTimes();
            sortBossesBySpawnTime();
            updateActiveBoss();
            populateBossSchedule();
            closeModal(addBossModal);
            saveToLocalStorage();
            
            // Reset form
            resetBossForm();
        }
        
        // Clear error messages
        function clearErrorMessages() {
            [levelError, nameError, timeError, intervalError].forEach(error => {
                error.style.display = 'none';
                error.textContent = '';
            });
            
            document.querySelectorAll('.error-input').forEach(el => {
                el.classList.remove('error-input');
            });
        }
        
        // Show error message
        function showError(element, message) {
            element.textContent = message;
            element.style.display = 'block';
        }
        
        // Update interval field visibility based on day selection
        function updateIntervalFieldVisibility() {
            const anyDaySelected = document.querySelectorAll('.day-checkbox:checked').length > 0;
            
            if (anyDaySelected) {
                intervalGroup.style.display = 'none';
                respawnIntervalInput.value = 0;
                respawnIntervalInput.required = false;
                intervalNote.innerHTML = '<strong>Weekly Schedule:</strong> Boss akan spawn pada hari yang dipilih setiap minggu pada jam yang sama.';
            } else {
                intervalGroup.style.display = 'block';
                respawnIntervalInput.value = respawnIntervalInput.value || 2;
                respawnIntervalInput.required = true;
                intervalNote.innerHTML = 'Untuk boss yang spawn setiap hari. Contoh: input 16:00 dengan interval 10h = next spawn 02:00';
            }
        }
        
        // Initialize audio context for alarm sound
        function initializeAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                createAlarmSound();
            } catch (e) {
                console.warn('Web Audio API not supported, alarm sound disabled');
                alarmMuted = true;
                updateAlarmButtons();
            }
        }
        
        // Create alarm sound using Web Audio API
        function createAlarmSound() {
            if (!audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.value = 0.25;
            
            alarmSound = {
                oscillator: oscillator,
                gainNode: gainNode,
                playing: false
            };
        }
        
        // Play alarm sound
        function playAlarmSound() {
            if (!alarmSound || alarmMuted || !alarmEnabled) return;
            
            try {
                if (audioContext.state === 'suspended') {
                    audioContext.resume();
                }
                
                alarmSound.oscillator.start();
                alarmSound.playing = true;
                
                const now = audioContext.currentTime;
                const beepDuration = 0.3;
                const pauseDuration = 0.2;
                
                // Beep 1
                alarmSound.gainNode.gain.setValueAtTime(0, now);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0.25, now + 0.05);
                alarmSound.gainNode.gain.setValueAtTime(0.25, now + beepDuration - 0.05);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0, now + beepDuration);
                
                // Beep 2
                alarmSound.gainNode.gain.setValueAtTime(0, now + beepDuration + pauseDuration);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0.25, now + beepDuration + pauseDuration + 0.05);
                alarmSound.gainNode.gain.setValueAtTime(0.25, now + 2*beepDuration + pauseDuration - 0.05);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0, now + 2*beepDuration + pauseDuration);
                
                // Beep 3
                alarmSound.gainNode.gain.setValueAtTime(0, now + 2*beepDuration + 2*pauseDuration);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0.25, now + 2*beepDuration + 2*pauseDuration + 0.05);
                alarmSound.gainNode.gain.setValueAtTime(0.25, now + 3*beepDuration + 2*pauseDuration - 0.05);
                alarmSound.gainNode.gain.linearRampToValueAtTime(0, now + 3*beepDuration + 2*pauseDuration);
                
                setTimeout(() => {
                    if (alarmSound && alarmSound.playing) {
                        alarmSound.oscillator.stop();
                        alarmSound.playing = false;
                        createAlarmSound();
                    }
                }, 2000);
                
            } catch (e) {
                console.warn('Failed to play alarm sound:', e);
            }
        }
        
        // Stop alarm sound
        function stopAlarmSound() {
            if (alarmSound && alarmSound.playing) {
                try {
                    alarmSound.oscillator.stop();
                    alarmSound.playing = false;
                    createAlarmSound();
                } catch (e) {
                    console.warn('Failed to stop alarm sound:', e);
                }
            }
        }
        
        // Test alarm sound
        function testAlarm() {
            if (alarmMuted) {
                showNotification('Alarm is muted. Unmute to test.', 'error');
                return;
            }
            
            playAlarmSound();
            showNotification('Testing alarm sound...', 'info');
        }
        
        // Update alarm button states
        function updateAlarmButtons() {
            toggleAlarmBtn.innerHTML = alarmEnabled ? 
                '<i class="fas fa-bell"></i> Alarm: ON' : 
                '<i class="fas fa-bell-slash"></i> Alarm: OFF';
            toggleAlarmBtn.classList.toggle('active', alarmEnabled);
            
            muteAlarmBtn.innerHTML = alarmMuted ? 
                '<i class="fas fa-volume-up"></i> Unmute' : 
                '<i class="fas fa-volume-mute"></i> Mute';
            muteAlarmBtn.classList.toggle('muted', alarmMuted);
        }
        
        // Check for alarm condition
        function checkAlarm() {
            if (!alarmEnabled || alarmCooldown) return;
            
            const activeBoss = bossSchedule.find(boss => boss.isActive);
            if (!activeBoss || !activeBoss.nextSpawnTime) return;
            
            const now = new Date();
            const spawnTime = new Date(activeBoss.nextSpawnTime);
            const timeDiff = Math.floor((spawnTime.getTime() - now.getTime()) / 1000);
            
            if (timeDiff <= ALARM_THRESHOLD && timeDiff > 0) {
                if (!alarmTriggered) {
                    triggerAlarm(activeBoss, timeDiff);
                }
            } else if (timeDiff > ALARM_THRESHOLD) {
                alarmTriggered = false;
                countdownTimer.classList.remove('alarm');
            }
        }
        
        // Trigger the alarm
        function triggerAlarm(boss, timeDiff) {
            alarmTriggered = true;
            
            countdownTimer.classList.add('alarm');
            
            playAlarmSound();
            
            const minutes = Math.floor(timeDiff / 60);
            const seconds = timeDiff % 60;
            alarmMessage.textContent = `${boss.name} will spawn in ${minutes}m ${seconds}s!`;
            alarmNotification.style.display = 'block';
            
            alarmCooldown = true;
            setTimeout(() => {
                alarmCooldown = false;
            }, 10000);
            
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(`BOSS ALERT: ${boss.name}`, {
                    body: `Will spawn in ${minutes} minutes!`,
                    icon: 'https://cdn-icons-png.flaticon.com/512/1995/1995515.png'
                });
            }
        }
        
        // Close alarm notification
        function closeAlarm() {
            alarmNotification.style.display = 'none';
            countdownTimer.classList.remove('alarm');
            stopAlarmSound();
        }
        
        // Load data from localStorage
        function loadFromLocalStorage() {
            const savedSchedule = localStorage.getItem('acumalakaBossSchedule');
            if (savedSchedule) {
                try {
                    bossSchedule = JSON.parse(savedSchedule);
                } catch (e) {
                    console.error('Error loading schedule:', e);
                }
            }
            
            const savedNotes = localStorage.getItem('acumalakaGuildNotes');
            if (savedNotes) {
                adminNotes.value = savedNotes;
            }
            
            const savedAlarmEnabled = localStorage.getItem('acumalakaAlarmEnabled');
            if (savedAlarmEnabled !== null) {
                alarmEnabled = savedAlarmEnabled === 'true';
            }
            
            const savedAlarmMuted = localStorage.getItem('acumalakaAlarmMuted');
            if (savedAlarmMuted !== null) {
                alarmMuted = savedAlarmMuted === 'true';
            }
        }
        
        // Save data to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('acumalakaBossSchedule', JSON.stringify(bossSchedule));
            localStorage.setItem('acumalakaGuildNotes', adminNotes.value);
            localStorage.setItem('acumalakaAlarmEnabled', alarmEnabled);
            localStorage.setItem('acumalakaAlarmMuted', alarmMuted);
        }
        
        // Calculate next spawn time for all bosses
        function calculateAllNextSpawnTimes() {
            const now = new Date();
            
            bossSchedule.forEach(boss => {
                if (!boss.lastSpawnTime) {
                    const hoursOffset = boss.respawnInterval > 0 ? boss.respawnInterval - 1 : 0;
                    boss.lastSpawnTime = new Date(now.getTime() - hoursOffset * 3600000);
                }
                
                const lastSpawn = new Date(boss.lastSpawnTime);
                let nextSpawn;
                
                if (boss.respawnInterval === 0 && boss.spawnDays && boss.spawnDays.length > 0) {
                    // Weekly schedule
                    nextSpawn = new Date(lastSpawn);
                    
                    // Find next occurrence
                    while (nextSpawn <= now || !boss.spawnDays.includes(nextSpawn.getDay())) {
                        nextSpawn.setDate(nextSpawn.getDate() + 1);
                    }
                    
                    // If we've gone past all days in the current week, jump to next week
                    if (nextSpawn <= now) {
                        nextSpawn.setDate(nextSpawn.getDate() + 7);
                    }
                } else {
                    // Interval schedule
                    nextSpawn = new Date(lastSpawn.getTime() + boss.respawnInterval * 3600000);
                    
                    while (nextSpawn <= now || !isValidSpawnDay(boss, nextSpawn)) {
                        nextSpawn.setTime(nextSpawn.getTime() + boss.respawnInterval * 3600000);
                    }
                }
                
                boss.nextSpawnTime = nextSpawn.toISOString();
                boss.isActive = false;
            });
            
            saveToLocalStorage();
        }
        
        // Sort bosses by spawn time
        function sortBossesBySpawnTime() {
            bossSchedule.sort((a, b) => {
                if (!a.nextSpawnTime && !b.nextSpawnTime) return 0;
                if (!a.nextSpawnTime) return 1;
                if (!b.nextSpawnTime) return -1;
                
                const timeA = new Date(a.nextSpawnTime).getTime();
                const timeB = new Date(b.nextSpawnTime).getTime();
                return timeA - timeB;
            });
            
            bossSchedule.forEach((boss, index) => {
                boss.spawnOrder = index + 1;
            });
        }
        
        // Check if a spawn day is valid
        function isValidSpawnDay(boss, spawnTime) {
            if (!boss.spawnDays || boss.spawnDays.length === 0) {
                return true;
            }
            
            const spawnDay = spawnTime.getDay();
            return boss.spawnDays.includes(spawnDay);
        }
        
        // Update which boss is active
        function updateActiveBoss() {
            const now = new Date();
            let closestBoss = null;
            let closestTime = Infinity;
            let closestIndex = -1;
            
            bossSchedule.forEach((boss, index) => {
                if (boss.nextSpawnTime) {
                    const spawnTime = new Date(boss.nextSpawnTime);
                    const timeDiff = spawnTime.getTime() - now.getTime();
                    
                    if (timeDiff > 0 && timeDiff < closestTime) {
                        closestTime = timeDiff;
                        closestBoss = boss;
                        closestIndex = index;
                    }
                }
            });
            
            if (closestBoss) {
                currentBossIndex = closestIndex;
                activeBossId = closestBoss.id;
                currentBoss.textContent = closestBoss.name;
                countdownSeconds = Math.floor(closestTime / 1000);
                
                bossSchedule.forEach(boss => {
                    boss.isActive = (boss.id === closestBoss.id);
                });
                
                const spawnTime = new Date(closestBoss.nextSpawnTime);
                const timeStr = spawnTime.toLocaleTimeString('en-US', { 
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                let dayInfo = '';
                if (closestBoss.spawnDays && closestBoss.spawnDays.length > 0) {
                    const days = closestBoss.spawnDays.map(d => DAYS_SHORT[d]).join(', ');
                    dayInfo = ` (${days})`;
                }
                
                bossSpawnTime.textContent = 
                    `${timeStr} | ${DAYS_OF_WEEK[spawnTime.getDay()]}${dayInfo}`;
            } else {
                currentBoss.textContent = 'No upcoming bosses';
                countdownSeconds = 0;
                bossSpawnTime.textContent = 'Check schedule for upcoming bosses';
            }
        }
        
        // Check if any boss has spawned
        function checkBossSpawn() {
            const now = new Date();
            let updated = false;
            
            bossSchedule.forEach(boss => {
                if (boss.nextSpawnTime && new Date(boss.nextSpawnTime) <= now) {
                    boss.lastSpawnTime = boss.nextSpawnTime;
                    
                    let nextSpawn;
                    const lastSpawn = new Date(boss.lastSpawnTime);
                    
                    if (boss.respawnInterval === 0 && boss.spawnDays && boss.spawnDays.length > 0) {
                        // Weekly schedule
                        nextSpawn = new Date(lastSpawn);
                        
                        // Find next occurrence
                        do {
                            nextSpawn.setDate(nextSpawn.getDate() + 1);
                        } while (!boss.spawnDays.includes(nextSpawn.getDay()));
                        
                        // Make sure it's in the future
                        if (nextSpawn <= now) {
                            nextSpawn.setDate(nextSpawn.getDate() + 7);
                        }
                    } else {
                        // Interval schedule
                        nextSpawn = new Date(lastSpawn.getTime() + boss.respawnInterval * 3600000);
                        
                        while (nextSpawn <= now || !isValidSpawnDay(boss, nextSpawn)) {
                            nextSpawn.setTime(nextSpawn.getTime() + boss.respawnInterval * 3600000);
                        }
                    }
                    
                    boss.nextSpawnTime = nextSpawn.toISOString();
                    updated = true;
                    
                    if (boss.isActive) {
                        showNotification(` ${boss.name} has spawned!`, 'success');
                        alarmTriggered = false;
                        countdownTimer.classList.remove('alarm');
                    }
                }
            });
            
            if (updated) {
                sortBossesBySpawnTime();
                updateActiveBoss();
                populateBossSchedule();
                saveToLocalStorage();
            }
        }
        
        // Initialize boss schedule table
        function populateBossSchedule() {
            bossScheduleTable.innerHTML = '';
            const now = new Date();
            const currentDay = now.getDay();
            
            if (bossSchedule.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="${isAdminLoggedIn ? '7' : '6'}" style="text-align: center; padding: 40px; color: var(--gray);">
                        <i class="fas fa-dragon" style="font-size: 2rem; margin-bottom: 10px; display: block; color: var(--light-red);"></i>
                        No bosses scheduled. Add your first boss to get started!
                    </td>
                `;
                bossScheduleTable.appendChild(emptyRow);
                return;
            }
            
            bossSchedule.forEach(boss => {
                const nextSpawn = boss.nextSpawnTime ? new Date(boss.nextSpawnTime) : null;
                const lastSpawn = boss.lastSpawnTime ? new Date(boss.lastSpawnTime) : null;
                
                let scheduleTypeHTML = '';
                let lastSpawnHTML = '';
                let nextSpawnHTML = '';
                let rowClass = '';
                
                if (boss.spawnDays && boss.spawnDays.length > 0 && !boss.spawnDays.includes(currentDay)) {
                    rowClass = 'inactive-day';
                }
                
                // Schedule type display
                if (boss.respawnInterval === 0 && boss.spawnDays && boss.spawnDays.length > 0) {
                    const days = boss.spawnDays.map(d => DAYS_SHORT[d]).join(', ');
                    scheduleTypeHTML = `<span class="fixed-schedule">Weekly: ${days}</span>`;
                } else if (boss.respawnInterval > 0) {
                    scheduleTypeHTML = `<span class="interval-schedule">Every ${boss.respawnInterval}h</span>`;
                }
                
                // Last spawn display
                if (lastSpawn) {
                    const timeStr = lastSpawn.toLocaleTimeString('en-US', { 
                        hour12: false, 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    const dateStr = lastSpawn.toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric'
                    });
                    lastSpawnHTML = `
                        <div>${timeStr}</div>
                        <div class="last-spawn-time">${dateStr}</div>
                    `;
                } else {
                    lastSpawnHTML = `<span style="color:var(--gray); font-size:0.9rem;">No record</span>`;
                }
                
                // Next spawn display
                if (nextSpawn) {
                    const timeDiff = nextSpawn.getTime() - now.getTime();
                    const daysLeft = Math.floor(timeDiff / (3600000 * 24));
                    const hoursLeft = Math.floor((timeDiff % (3600000 * 24)) / 3600000);
                    const minutesLeft = Math.floor((timeDiff % 3600000) / 60000);
                    
                    let timeLeftText = '';
                    if (daysLeft > 0) {
                        timeLeftText = `${daysLeft}d ${hoursLeft}h left`;
                    } else if (hoursLeft > 0) {
                        timeLeftText = `${hoursLeft}h ${minutesLeft}m left`;
                    } else {
                        timeLeftText = `${minutesLeft}m left`;
                    }
                    
                    const alarmIndicator = timeDiff <= ALARM_THRESHOLD && timeDiff > 0 ? 
                        '<span class="alarm-indicator">ALARM!</span>' : '';
                    
                    const nextSpawnTimeStr = nextSpawn.toLocaleTimeString('en-US', { 
                        hour12: false, 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    
                    nextSpawnHTML = `
                        <div class="next-spawn-time">${nextSpawnTimeStr} ${alarmIndicator}</div>
                        <div class="last-spawn-time">${timeLeftText}</div>
                    `;
                } else {
                    nextSpawnHTML = `<span style="color:var(--gray); font-size:0.9rem;">Schedule not set</span>`;
                }
                
                const row = document.createElement('tr');
                if (boss.isActive) {
                    row.className = 'active-boss';
                } else if (rowClass) {
                    row.className = rowClass;
                }
                
                row.innerHTML = `
                    <td><span class="spawn-order">${boss.spawnOrder}</span></td>
                    <td><span class="boss-level">${boss.level}</span></td>
                    <td>
                        <strong>${boss.name}</strong>
                        ${boss.isActive ? '<span class="active-indicator">NEXT</span>' : ''}
                        ${boss.spawnDays && boss.spawnDays.length > 0 && !boss.spawnDays.includes(currentDay) ? 
                          '<span class="day-off-badge">NOT TODAY</span>' : ''}
                    </td>
                    <td>${scheduleTypeHTML}</td>
                    <td>${lastSpawnHTML}</td>
                    <td>${nextSpawnHTML}</td>
                    <td class="admin-only-block" style="display: ${isAdminLoggedIn ? 'table-cell' : 'none'};">
                        <button class="action-btn edit-boss-btn" data-id="${boss.id}" title="Edit Boss">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-boss-btn" data-id="${boss.id}" title="Delete Boss">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                bossScheduleTable.appendChild(row);
            });
            
            // Add event listeners to action buttons
            setTimeout(() => {
                document.querySelectorAll('.edit-boss-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const bossId = parseInt(this.getAttribute('data-id'));
                        editBoss(bossId);
                    });
                });
                
                document.querySelectorAll('.delete-boss-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const bossId = parseInt(this.getAttribute('data-id'));
                        confirmDeleteBoss(bossId);
                    });
                });
            }, 0);
        }
        
        // Update time displays
        function updateTimes() {
            const now = new Date();
            
            // INDO TIME (UTC+7)
            const indoTimeObj = new Date(now.getTime() + (7 * 60 * 60 * 1000));
            const indoTimeStr = indoTimeObj.toISOString().substr(11, 8);
            indoTime.textContent = indoTimeStr;
            
            // PH TIME (UTC+8)
            const phTimeObj = new Date(now.getTime() + (8 * 60 * 60 * 1000));
            const phTimeStr = phTimeObj.toISOString().substr(11, 8);
            phTime.textContent = phTimeStr;
            
            updateCountdown();
        }
        
        // Update countdown timer
        function updateCountdown() {
            countdownSeconds--;
            
            if (countdownSeconds < 0) {
                countdownSeconds = 0;
            }
            
            const days = Math.floor(countdownSeconds / (3600 * 24));
            const hours = Math.floor((countdownSeconds % (3600 * 24)) / 3600);
            const minutes = Math.floor((countdownSeconds % 3600) / 60);
            const seconds = countdownSeconds % 60;
            
            let formattedTime = '';
            if (days > 0) {
                formattedTime = 
                    days.toString().padStart(2, '0') + 'd ' +
                    hours.toString().padStart(2, '0') + ':' +
                    minutes.toString().padStart(2, '0') + ':' +
                    seconds.toString().padStart(2, '0');
            } else if (hours > 0) {
                formattedTime = 
                    hours.toString().padStart(2, '0') + ':' +
                    minutes.toString().padStart(2, '0') + ':' +
                    seconds.toString().padStart(2, '0');
            } else {
                formattedTime = 
                    minutes.toString().padStart(2, '0') + ':' +
                    seconds.toString().padStart(2, '0');
            }
            
            countdownTimer.textContent = formattedTime;
            
            if (countdownSeconds <= ALARM_THRESHOLD && countdownSeconds > 0) {
                countdownTimer.style.color = '#ff0000';
                countdownTimer.style.textShadow = '0 0 10px rgba(255, 0, 0, 0.5)';
            } else if (countdownSeconds < 300) {
                countdownTimer.style.color = '#dc2626';
                countdownTimer.style.textShadow = '0 0 10px rgba(220, 38, 38, 0.5)';
            } else {
                countdownTimer.style.color = '#dc2626';
                countdownTimer.style.textShadow = '0 0 10px rgba(220, 38, 38, 0.2)';
            }
        }
        
        // Admin login/logout functions
        function loginAdmin(username, password, silent = false) {
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isAdminLoggedIn = true;
                document.body.classList.add('admin-logged-in');
                adminLoginBtn.style.display = 'none';
                adminLogoutBtn.style.display = 'flex';
                adminNotes.readOnly = false;
                
                document.querySelectorAll('.admin-only').forEach(el => {
                    el.style.display = 'inline-flex';
                });
                document.querySelectorAll('.admin-only-block').forEach(el => {
                    el.style.display = 'block';
                });
                document.querySelectorAll('td.admin-only-block').forEach(el => {
                    el.style.display = 'table-cell';
                });
                
                // Save admin session
                localStorage.setItem('acumalakaAdminLoggedIn', 'true');
                
                if (!silent) {
                    showNotification('Admin login successful!', 'success');
                }
                closeModal(loginModal);
                return true;
            } else {
                if (!silent) {
                    showNotification('Invalid username or password', 'error');
                }
                return false;
            }
        }
        
        function logoutAdmin() {
            isAdminLoggedIn = false;
            document.body.classList.remove('admin-logged-in');
            adminLoginBtn.style.display = 'flex';
            adminLogoutBtn.style.display = 'none';
            adminNotes.readOnly = true;
            
            document.querySelectorAll('.admin-only').forEach(el => {
                el.style.display = 'none';
            });
            document.querySelectorAll('.admin-only-block').forEach(el => {
                el.style.display = 'none';
            });
            document.querySelectorAll('td.admin-only-block').forEach(el => {
                el.style.display = 'none';
            });
            
            // Clear admin session
            localStorage.removeItem('acumalakaAdminLoggedIn');
            
            showNotification('Admin logged out', 'info');
        }
        
        // Modal functions
        function openModal(modal) {
            modal.style.display = 'flex';
        }
        
        function closeModal(modal) {
            modal.style.display = 'none';
        }
        
        // Reset boss form
        function resetBossForm() {
            document.getElementById('addBossForm').reset();
            editBossIdInput.value = '';
            bossModalTitle.innerHTML = '<i class="fas fa-dragon"></i> Add New Field Boss';
            saveBossBtn.textContent = 'Add Boss';
            
            const now = new Date();
            document.getElementById('spawnHour').value = now.getHours();
            document.getElementById('spawnMinute').value = now.getMinutes();
            document.getElementById('respawnInterval').value = 2;
            
            document.querySelectorAll('.day-checkbox').forEach(cb => {
                cb.checked = false;
            });
            
            updateIntervalFieldVisibility();
            clearErrorMessages();
        }
        
        // Add new boss
        function addNewBoss() {
            resetBossForm();
            openModal(addBossModal);
        }
        
        // Edit boss function
        function editBoss(bossId) {
            const boss = bossSchedule.find(b => b.id === bossId);
            if (!boss) return;
            
            // Reset form
            document.getElementById('addBossForm').reset();
            
            // Set form values
            document.getElementById('bossLevel').value = boss.level;
            document.getElementById('bossName').value = boss.name;
            document.getElementById('bossType').value = boss.type;
            document.getElementById('respawnInterval').value = boss.respawnInterval || 2;
            document.getElementById('bossNotes').value = boss.notes || '';
            editBossIdInput.value = boss.id;
            
            // Show LAST spawn time
            if (boss.lastSpawnTime) {
                const lastSpawn = new Date(boss.lastSpawnTime);
                document.getElementById('spawnHour').value = lastSpawn.getHours();
                document.getElementById('spawnMinute').value = lastSpawn.getMinutes();
            } else {
                const now = new Date();
                document.getElementById('spawnHour').value = now.getHours();
                document.getElementById('spawnMinute').value = now.getMinutes();
            }
            
            // Fill day checkboxes
            if (boss.spawnDays) {
                document.querySelectorAll('.day-checkbox').forEach(cb => {
                    cb.checked = boss.spawnDays.includes(parseInt(cb.value));
                });
            } else {
                document.querySelectorAll('.day-checkbox').forEach(cb => {
                    cb.checked = false;
                });
            }
            
            // Update interval field visibility
            updateIntervalFieldVisibility();
            
            bossModalTitle.innerHTML = '<i class="fas fa-edit"></i> Edit Field Boss';
            saveBossBtn.textContent = 'Update Boss';
            
            openModal(addBossModal);
        }
        
        // Confirm delete boss
        function confirmDeleteBoss(bossId) {
            const boss = bossSchedule.find(b => b.id === bossId);
            if (!boss) return;
            
            currentBossToDelete = bossId;
            document.getElementById('confirmMessage').textContent = 
                `Are you sure you want to delete "${boss.name}" from the schedule?`;
            
            openModal(confirmModal);
        }
        
        // Delete boss function (confirmed)
        function deleteBossConfirmed(bossId) {
            bossSchedule = bossSchedule.filter(b => b.id !== bossId);
            calculateAllNextSpawnTimes();
            sortBossesBySpawnTime();
            updateActiveBoss();
            populateBossSchedule();
            saveToLocalStorage();
            showNotification('Boss deleted from schedule', 'success');
            currentBossToDelete = null;
        }
        
        // Show notification
        function showNotification(message, type = 'success') {
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            let bgColor, textColor, borderColor;
            switch(type) {
                case 'error':
                    bgColor = 'var(--danger-red)';
                    borderColor = 'var(--dark-red)';
                    textColor = 'var(--pure-white)';
                    break;
                case 'warning':
                    bgColor = 'var(--warning-yellow)';
                    borderColor = '#d97706';
                    textColor = 'var(--pure-white)';
                    break;
                case 'info':
                    bgColor = 'var(--info-blue)';
                    borderColor = '#1d4ed8';
                    textColor = 'var(--pure-white)';
                    break;
                default: // success
                    bgColor = 'var(--success-green)';
                    borderColor = '#059669';
                    textColor = 'var(--pure-white)';
            }
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: ${textColor};
                padding: 15px 25px;
                border-radius: 10px;
                z-index: 1000;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                animation: slideIn 0.3s ease-out;
                font-weight: 600;
                border: 2px solid ${borderColor};
                max-width: 300px;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // Add CSS for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Initialize the application
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
